{% extends 'base.html' %}
{% block content %}

<div class="max-w-4xl mx-auto">

  <a href="/" class="text-gray-600">← Voltar</a>
  <h2 class="text-3xl font-bold mt-4">M/M/1 — Prioridade Preemptiva</h2>
  <p class="text-gray-500 mt-1">Classes com prioridade podem interromper as inferiores</p>

  <!-- FORM -->
  <form method="post" class="bg-white p-6 rounded-lg shadow mt-6">
    <h3 class="text-xl font-semibold mb-4">Parâmetros</h3>

    <div>
      <label class="text-sm">Taxa de Serviço (μ)</label>
      <input name="mu" value="{{ params.mu }}" class="w-full p-2 border rounded mb-4">
    </div>

    <h4 class="font-semibold mt-3 mb-2">Taxas de Chegada (λ) por Classe</h4>

    <div id="lambda-container">
      <div class="grid grid-cols-1 gap-3 mb-2">
        <input name="lambda[]" class="p-2 border rounded" placeholder="λ">
      </div>
    </div>

    <button type="button"
            class="bg-gray-200 px-3 py-1 rounded text-sm"
            onclick="addLambdaRow()">
      + Adicionar Classe
    </button>

    <button class="w-full bg-blue-600 text-white py-2 rounded mt-4">Calcular</button>
  </form>

  <!-- RESULTADOS -->
  {% if metrics %}
  <div class="bg-white p-6 rounded-lg shadow mt-6">
    <h3 class="text-xl font-semibold mb-4">Resultados</h3>

    {% for class_name, data in metrics.items() %}
      <h4 class="text-lg font-bold mt-4">{{ class_name }}</h4>

      {% for k, v in data.items() %}
      <div class="flex justify-between py-1 border-b">
        <span>{{ k }}</span>
        <span class="font-semibold">{{ v }}</span>
      </div>
      {% endfor %}
    {% endfor %}
  </div>
  {% endif %}

</div>

<script>
function addLambdaRow() {
  document.getElementById("lambda-container").insertAdjacentHTML(
    "beforeend",
    `
    <div class="grid grid-cols-1 gap-3 mb-2">
        <input name="lambda[]" class="p-2 border rounded" placeholder="λ">
    </div>
    `
  );
}
</script>

{% endblock %}
